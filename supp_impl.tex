%!TEX root = main.tex 

% \clearpage
\section{Implementation detail}
% \harry{move the deleted stuff in the main paper to here}
\label{sec:implementation}

The architecture of our model is presented in \ref{fig:architecture}. 
We first encode image inputs using a Convolutional Neural Network (CNN), in this case a pretrained \resn-18~\citep{he2016deep}, and then project the output into an high-dimension representation space with a projection head made of multi-layer perceptron (MLP). 
In our experiments we use one non-linear layer to project the output of the CNN into our representation space. 
For classifcation task we add an MLP classifier head. 
We also use one non-linear layer with softmax activation. 
For triplet prediction, we will re-index the representations with the current triplet batch and calculate prediction or loss.
We use the PyTorch framework \cite{pytorch} and the PyTorch Lightning framework \cite{pytorch-lightning} for implementation.
Hyperparameters will be reported in \ref{sec:supp_human} for models in the human experiments and in \ref{sec:supp_syn} for models in the synthetic experiments.

\begin{figure}[t]
    \centering
    \includegraphics[width=\textwidth]{figures/general/architecture.pdf}
    \caption{Architecture of the \mtl model.}
    \label{fig:architecture}
\end{figure}

% \subsection{Hyperparameters}
% \cc{add model hyperparameter}
% Han: pushed to VW and BM sections.

% \chenhao{add model structure}

% \han{do we talk about random seed?}
% \chenhao{probably no}


\subsection{Computation resources}
We use a computing cluster at our institution. We train our models on nodes with different GPUs including Nvidia GeForce RTX2080Ti, Nvidia GeForce RTX3090, Nvidia Quadro RTX 8000, and Nvidia A40. All models are trained on one allocated node with one GPU access.


% \subsection{Reproducibility}
% Our source code of the implementation is included in this url: 
% We submit a preliminary version of the code and data.
% We will release more details upon acceptance.
% \han{To be zipped and upload: MTL model, trainer, evaluation script}.
% \harry{We provde soure code if acceptance?}

% Data? \han{Shall we publish the data as well?}

% Upon acceptance?
